{"ast":null,"code":"'use strict';\n\nconst colors = require('colors/safe');\nconst DEFAULT_ADAPTER = 'postgres';\nconst ADAPTERS = {\n  'postgres': './adapters/postgres.js'\n};\nclass Database {\n  constructor() {\n    this.adapter = null;\n    this._useLogColor = 0;\n  }\n  connect(cfg) {\n    if (typeof cfg === 'string') {\n      cfg = {\n        connectionString: cfg\n      };\n    }\n    const Adapter = require(ADAPTERS[cfg.adapter] || ADAPTERS[DEFAULT_ADAPTER]);\n    this.adapter = new Adapter(this, cfg);\n    return true;\n  }\n  close(callback) {\n    this.adapter.close.apply(this, arguments);\n    callback && callback.call(this);\n    return true;\n  }\n  log(sql, params, time) {\n    let colorFunc = this.__logColorFuncs[this._useLogColor];\n    console.log();\n    console.log(colorFunc(sql));\n    params && console.log(colorFunc(JSON.stringify(params)));\n    time && console.log(colorFunc(time + 'ms'));\n    console.log();\n    this._useLogColor = (this._useLogColor + 1) % this.__logColorFuncs.length;\n    return true;\n  }\n  info(message) {\n    console.log(colors.green.bold('Database Info: ') + message);\n  }\n  error(message) {\n    console.log(colors.red.bold('Database Error: ') + message);\n    return true;\n  }\n  query() {\n    this.adapter.query.apply(this.adapter, arguments);\n  }\n  transaction() {\n    this.adapter.transaction.apply(this.adapter, arguments);\n  }\n  drop() {\n    this.adapter.drop.apply(this.adapter, arguments);\n  }\n  create() {\n    this.adapter.create.apply(this.adapter, arguments);\n  }\n}\nDatabase.prototype.__logColorFuncs = [str => {\n  return colors.yellow.bold(str);\n}, str => {\n  return colors.white(str);\n}];\nmodule.exports = Database;","map":{"version":3,"names":["colors","require","DEFAULT_ADAPTER","ADAPTERS","Database","constructor","adapter","_useLogColor","connect","cfg","connectionString","Adapter","close","callback","apply","arguments","call","log","sql","params","time","colorFunc","__logColorFuncs","console","JSON","stringify","length","info","message","green","bold","error","red","query","transaction","drop","create","prototype","str","yellow","white","module","exports"],"sources":["/Users/apps/node_modules/carthage/core/required/db/database.js"],"sourcesContent":["'use strict';\n\nconst colors = require('colors/safe');\n\nconst DEFAULT_ADAPTER = 'postgres';\nconst ADAPTERS = {\n  'postgres': './adapters/postgres.js',\n};\n\nclass Database {\n\n  constructor() {\n\n    this.adapter = null;\n    this._useLogColor = 0;\n\n  }\n\n  connect(cfg) {\n\n    if (typeof cfg === 'string') {\n      cfg = {connectionString: cfg};\n    }\n\n    const Adapter = require(ADAPTERS[cfg.adapter] || ADAPTERS[DEFAULT_ADAPTER]);\n    this.adapter = new Adapter(this, cfg);\n\n    return true;\n\n  }\n\n  close(callback) {\n\n    this.adapter.close.apply(this, arguments);\n    callback && callback.call(this);\n    return true;\n\n  }\n\n  log(sql, params, time) {\n\n    let colorFunc = this.__logColorFuncs[this._useLogColor];\n\n    console.log();\n    console.log(colorFunc(sql));\n    params && console.log(colorFunc(JSON.stringify(params)));\n    time && console.log(colorFunc(time + 'ms'));\n    console.log();\n\n    this._useLogColor = (this._useLogColor + 1) % this.__logColorFuncs.length;\n\n    return true;\n\n  }\n\n  info(message) {\n\n    console.log(colors.green.bold('Database Info: ') + message);\n\n  }\n\n  error(message) {\n\n    console.log(colors.red.bold('Database Error: ') + message);\n    return true;\n\n  }\n\n  query() {\n\n    this.adapter.query.apply(this.adapter, arguments);\n\n  }\n\n  transaction() {\n\n    this.adapter.transaction.apply(this.adapter, arguments);\n\n  }\n\n  drop() {\n\n    this.adapter.drop.apply(this.adapter, arguments);\n\n  }\n\n  create() {\n\n    this.adapter.create.apply(this.adapter, arguments);\n\n  }\n\n}\n\nDatabase.prototype.__logColorFuncs = [\n  (str) => {\n    return colors.yellow.bold(str);\n  },\n  (str) => {\n    return colors.white(str);\n  }\n];\n\nmodule.exports = Database;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}